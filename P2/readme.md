# EXP2 P2P 訊息傳遞系統

## 項目需求

根據 EXP2 設計講義，本項目需要實現一個點對點（P2P）訊息傳遞系統，具備以下核心功能：

1. **Windows Form 座標系統理解**：實現基於左上角 (0,0) 座標系統的 UI 元件定位
2. **相互傳遞機制**：實現兩台電腦之間的雙向訊息傳遞
3. **網路架構**：採用 P2P 架構，每台電腦同時具備 Sender 和 Listener 功能

## 技術棧

- **開發語言**：C#
- **UI 框架**：Windows Forms (.NET)
- **網路通訊**：TCP/UDP Socket 程式設計
- **資料處理**：筆跡資料記錄器和資料→筆跡記錄器
- **開發環境**：Visual Studio
- **目標平台**：Windows 桌面應用程式

## 功能列表

### 1. 座標系統管理
- [x] 實現 Windows Form 座標系統 (左上角為原點)
- [x] 處理元件位置屬性 (location.x, location.y)
- [x] 管理元件尺寸 (width, height)
- [x] 座標轉換和定位計算

### 2. 網路通訊功能
- [ ] **Sender 功能**
  - 建立 TCP/UDP 連線
  - 傳送筆跡資料到目標 IP (如：192.168.0.200)
  - 資料封包格式化和傳輸
  
- [ ] **Listener 功能**
  - 監聽指定埠號的連線請求
  - 接收來自其他節點的筆跡資料
  - 資料解析和處理

### 3. 筆跡處理系統
- [ ] **筆跡→資料記錄器**
  - 捕捉滑鼠/觸控筆軌跡
  - 將筆跡轉換為座標點序列
  - 資料壓縮和編碼
  
- [ ] **資料→筆跡記錄器**
  - 接收網路傳來的座標資料
  - 重建筆跡軌跡
  - 在畫布上重現筆跡

### 4. P2P 架構實現
- [ ] 雙向通訊機制
- [ ] 節點發現和連線管理
- [ ] 同步機制確保資料一致性
- [ ] 錯誤處理和重連機制

## 實作方法

### 階段 1：基礎 UI 建立
1. 建立 Windows Form 主視窗
2. 實現座標系統和繪圖區域
3. 添加網路設定介面（IP 位址、埠號設定）

### 階段 2：筆跡捕捉系統
1. 實現滑鼠事件處理 (MouseDown, MouseMove, MouseUp)
2. 建立筆跡資料結構 (座標點、時間戳、筆觸屬性)
3. 實現即時繪圖功能

### 階段 3：網路通訊模組
1. 建立 TCP Socket 伺服器 (Listener)
2. 建立 TCP Socket 客戶端 (Sender)
3. 實現資料序列化和反序列化
4. 添加連線狀態管理

### 階段 4：P2P 整合
1. 整合 Sender 和 Listener 功能
2. 實現雙向資料同步
3. 添加多節點支援
4. 實現錯誤處理機制

### 階段 5：測試和優化
1. 本地回環測試
2. 區域網路測試 (192.168.0.100 ↔ 192.168.0.200)
3. 效能優化和穩定性測試

## 網路架構說明

```
電腦 A (192.168.0.100)          電腦 B (192.168.0.200)
┌─────────────────┐            ┌─────────────────┐
│     Sender      │◄──────────►│    Listener     │
│                 │   筆跡資料   │                 │
│    Listener     │◄──────────►│     Sender      │
└─────────────────┘            └─────────────────┘
        │                              │
        ▼                              ▼
┌─────────────────┐            ┌─────────────────┐
│   繪圖區域      │            │   繪圖區域      │
│ (即時同步顯示)   │            │ (即時同步顯示)   │
└─────────────────┘            └─────────────────┘
```

## 開發注意事項

1. **座標系統**：注意 Windows Form 使用左上角為 (0,0) 的座標系統
2. **網路安全**：實現基本的資料驗證和錯誤處理
3. **效能考量**：筆跡資料量可能很大，需要考慮資料壓縮
4. **使用者體驗**：提供清晰的連線狀態指示和錯誤訊息
5. **測試環境**：確保防火牆設定允許應用程式通訊

## 預期成果

完成後的系統應能實現：
- 兩台電腦之間的即時筆跡同步
- 穩定的 P2P 連線
- 流暢的繪圖體驗
- 可靠的資料傳輸

## 技術挑戰

1. **即時性**：確保筆跡傳輸的低延遲
2. **資料完整性**：防止筆跡資料遺失或錯序
3. **網路穩定性**：處理網路中斷和重連
4. **多點同步**：支援多個節點同時連線（進階功能）
